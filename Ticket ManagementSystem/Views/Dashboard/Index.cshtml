@model DashboardViewModel

@{
    ViewData["Title"] = "Dashboard";
    Layout = "~/Views/Shared/_DashboardLayout.cshtml";
}

<div class="container-fluid">
    <!--  -->
    <div class="row mb-4">
        @* Users *@
        <div class="col-md-4">
            <div class="card text-white bg-primary shadow-sm mb-3">
                <div class="card-body">
                    <h5 class="card-title">Users</h5>
                    <p class="card-text fs-4">@Model.CountOfUser</p>
                </div>
            </div>
        </div>

        @* Roles *@
        <div class="col-md-4">
            <div class="card text-white bg-secondary shadow-sm mb-3">
                <div class="card-body">
                    <h5 class="card-title">Roles</h5>
                    <p class="card-text fs-4">@Model.CountOfRoles</p>
                </div>
            </div>
        </div>

        @* Comments *@
        <div class="col-md-4">
            <div class="card text-white bg-dark shadow-sm mb-3">
                <div class="card-body">
                    <h5 class="card-title">Comments</h5>
                    <p class="card-text fs-4">@Model.CountOfComment / @Model.CountOfAllComment</p>
                </div>
            </div>
        </div>
    </div>

    <div class="row mb-4">
        @* Projects *@
        <div class="col-md-4">
            <div class="card text-white bg-info shadow-sm mb-3">
                <div class="card-body">
                    <h5 class="card-title">Projects</h5>
                    <p class="card-text fs-4">@Model.CountOfProject / @Model.CountOfAllProject</p>
                </div>
            </div>
        </div>

        @* Tasks *@
        <div class="col-md-4">
            <div class="card text-white bg-success shadow-sm mb-3">
                <div class="card-body">
                    <h5 class="card-title">Tasks</h5>
                    <p class="card-text fs-4">@Model.CountOfTask / @Model.CountOfAllTask</p>
                </div>
            </div>
        </div>

        @* Tickets *@
        <div class="col-md-4">
            <div class="card text-white bg-warning shadow-sm mb-3">
                <div class="card-body">
                    <h5 class="card-title">Tickets</h5>
                    <p class="card-text fs-4">@Model.CountOfTicket / @Model.CountOfAllTicket</p>
                </div>
            </div>
        </div>
    </div>

    <!-- الرسوم البيانية -->
    <div class="row mt-5">
        <!-- Ticket Chart -->
        <div class="col-md-6">
            <div class="card shadow-sm">
                <div class="card-header fw-bold">Ticket Distribution</div>
                <div class="card-body">
                    <canvas id="ticketChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Task Chart -->
        <div class="col-md-6">
            <div class="card shadow-sm">
                <div class="card-header fw-bold">Task Distribution</div>
                <div class="card-body">
                    <canvas id="taskChart"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        // ✅ Ticket Chart
        const ticketChart = new Chart(document.getElementById('ticketChart'), {
            type: 'doughnut',
            data: {
                labels: ['Active', 'Deleted'],
                datasets: [{
                    data: [@Model.CountOfTicket, @Model.CountOfAllTicket - @Model.CountOfTicket],
                    backgroundColor: ['#ffc107', '#e2e3e5'], // Yellow, Grey
                    borderWidth: 1
                }]
            },
            options: {
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                }
            }
        });

        // ✅ Task Chart
        const taskChart = new Chart(document.getElementById('taskChart'), {
            type: 'doughnut',
            data: {
                labels: ['Active', 'Deleted'],
                datasets: [{
                    data: [@Model.CountOfTask, @Model.CountOfAllTask - @Model.CountOfTask],
                    backgroundColor: ['#198754', '#e2e3e5'], // Green, Grey
                    borderWidth: 1
                }]
            },
            options: {
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                }
            }
        });
    </script>
}
